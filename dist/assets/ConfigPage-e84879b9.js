import{q as A,o as d,b as i,w as o,c as l,u as V,H as Z,a as k,t as b,E as $,a0 as x,A as ee,a1 as ae,I as N,G as E,l as c,D as q,g as S,F as y,n as j,K as te,M as D,a4 as H,a5 as J,e as Q,m as W,k as R,a2 as le,z as F,a6 as G,J as B,a7 as I,Q as O,R as z}from"./index-7e5a38e4.js";import{_ as oe}from"./ConfigDetailCard-5542b7f5.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";const de={class:"d-sm-flex align-center justify-space-between"},se=A({__name:"ConfigGroupCard",props:{title:String},setup(m){const e=m;return(a,h)=>(d(),i(E,{variant:"outlined",elevation:"0",class:"withbg",style:{width:"50%"}},{default:o(()=>[l(x,{style:{padding:"10px 20px"}},{default:o(()=>[V("div",de,[l(Z,null,{default:o(()=>[k(b(e.title),1)]),_:1}),l($)])]),_:1}),l(ee),l(N,null,{default:o(()=>[ae(a.$slots,"default")]),_:3})]),_:3}))}}),ie={style:{display:"flex","flex-direction":"row","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},me={style:{display:"flex","flex-direction":"row"}},ue={style:{"margin-right":"10px",color:"black"}},re={style:{color:"#222"}},fe=A({__name:"ConfigGroupItem",props:{title:String,desc:String,btnRoute:String,namespace:String},setup(m){const e=m;return(a,h)=>(d(),c("div",ie,[V("div",me,[V("h3",ue,b(e.title),1),V("p",re,b(e.desc),1)]),l(q,{to:e.btnRoute,color:"primary",class:"ml-2",style:{"border-radius":"10px"}},{default:o(()=>[k("配置")]),_:1},8,["to"])]))}}),ge={props:{metadata:Object,iterable:Object,metadataKey:String}},_e={key:0,style:{"margin-bottom":"8px"}};function ce(m,e,a,h,T,t){var s,r;return d(),c(y,null,[a.iterable&&((s=a.metadata[a.metadataKey])==null?void 0:s.type)==="object"?(d(),c("h3",_e,b((r=a.metadata[a.metadataKey])==null?void 0:r.description),1)):S("",!0),l(N,null,{default:o(()=>[(d(!0),c(y,null,j(a.iterable,(g,n)=>(d(),i(te,{key:n,style:{"margin-bottom":"0.5px"}},{default:o(()=>{var C,U,w,K,u,L,P,M,_;return[((C=a.metadata[a.metadataKey].items[n])==null?void 0:C.type)==="string"&&n!=="name"?(d(),i(D,{key:0,modelValue:a.iterable[n],"onUpdate:modelValue":f=>a.iterable[n]=f,label:((U=a.metadata[a.metadataKey].items[n])==null?void 0:U.description)+"("+n+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):S("",!0),(((w=a.metadata[a.metadataKey].items[n])==null?void 0:w.type)==="int"||((K=a.metadata[a.metadataKey].items[n])==null?void 0:K.type)==="float")&&n!=="name"?(d(),i(D,{key:1,modelValue:a.iterable[n],"onUpdate:modelValue":f=>a.iterable[n]=f,label:((u=a.metadata[a.metadataKey].items[n])==null?void 0:u.description)+"("+n+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):((L=a.metadata[a.metadataKey].items[n])==null?void 0:L.type)==="bool"?(d(),i(H,{key:2,modelValue:a.iterable[n],"onUpdate:modelValue":f=>a.iterable[n]=f,label:((P=a.metadata[a.metadataKey].items[n])==null?void 0:P.description)+"("+n+")",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label"])):((M=a.metadata[a.metadataKey].items[n])==null?void 0:M.type)==="list"?(d(),i(J,{key:3,variant:"outlined",modelValue:a.iterable[n],"onUpdate:modelValue":f=>a.iterable[n]=f,chips:"",clearable:"",label:((_=a.metadata[a.metadataKey].items[n])==null?void 0:_.description)+"("+n+")",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:o(({attrs:f,item:v,select:X,selected:Y})=>[l(Q,W(f,{"model-value":Y,closable:"",onClick:X,"onClick:close":he=>m.remove(v)}),{default:o(()=>[V("strong",null,b(v),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):S("",!0)]}),_:2},1024))),128))]),_:1})],64)}const p=ne(ge,[["render",ce]]);const be=V("h2",null,"消息平台",-1),pe=V("h2",{style:{"margin-bottom":"16px","margin-top":"16px"}},"通用配置",-1),Ve=V("h2",null,"LLM",-1),ve=V("h2",{style:{"margin-bottom":"16px"}},"通用配置",-1),ye={name:"ConfigPage",components:{ConfigGroupCard:se,ConfigGroupItem:fe,ConfigDetailCard:oe,AstrBotConfig:p},data(){return{config_data:{config:{platform:[],llm:[],platform_settings:{},content_safety:{},llm_settings:{}}},metadata:{},save_message_snack:!1,save_message:"",save_message_success:"",namespace:"",tab:0,tabPlatform:0,tabLLM:0,tabs_key:["消息平台","大语言模型","其他配置"],common_configs_key:[]}},mounted(){this.getConfig()},methods:{getConfig(){F.get("/api/config/get").then(m=>{this.config_data=m.data.data.config,this.metadata=m.data.data.metadata;for(let e in this.config_data)e!="platform"&&e!="llm"&&e!="platform_settings"&&e!="llm_settings"&&e!="content_safety"&&this.common_configs_key.push(e)}).catch(m=>{save_message=m,save_message_snack=!0,save_message_success="error"})},updateConfig(){F.post("/api/config/astrbot/update",this.config_data).then(m=>{m.data.status==="success"?(this.save_message=m.data.message,this.save_message_snack=!0,this.save_message_success="success"):(this.save_message=m.data.message,this.save_message_snack=!0,this.save_message_success="error")}).catch(m=>{this.save_message=m,this.save_message_snack=!0,this.save_message_success="error"})}}},Ke=Object.assign(ye,{setup(m){return(e,a)=>{const h=R("v-tabs-window-item"),T=R("v-tabs-window");return d(),c(y,null,[l(E,null,{default:o(()=>[l(G,{modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=t=>e.tab=t),"align-tabs":"center",color:"deep-purple-accent-4"},{default:o(()=>[(d(!0),c(y,null,j(e.tabs_key,(t,s)=>(d(),i(I,{key:s,value:s},{default:o(()=>[k(b(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),l(T,{modelValue:e.tab,"onUpdate:modelValue":a[5]||(a[5]=t=>e.tab=t)},{default:o(()=>[e.tab===0?(d(),i(h,{key:0},{default:o(()=>[l(B,{fluid:""},{default:o(()=>{var t,s,r,g,n,C,U,w,K,u,L,P,M;return[be,l(G,{style:{"margin-top":"16px"},modelValue:e.tabPlatform,"onUpdate:modelValue":a[1]||(a[1]=_=>e.tabPlatform=_),"align-tabs":"left",color:"deep-purple-accent-4"},{default:o(()=>{var _;return[(d(!0),c(y,null,j((_=e.config_data)==null?void 0:_.platform,(f,v)=>(d(),i(I,{key:v,value:v},{default:o(()=>[k(b(f.id)+"("+b(f.name)+") ",1)]),_:2},1032,["value"]))),128))]}),_:1},8,["modelValue"]),l(T,{modelValue:e.tabPlatform,"onUpdate:modelValue":a[2]||(a[2]=_=>e.tabPlatform=_)},{default:o(()=>{var _;return[(d(!0),c(y,null,j((_=e.config_data)==null?void 0:_.platform,(f,v)=>O((d(),i(h,{key:v,value:v},{default:o(()=>[l(B,null,{default:o(()=>[l(p,{metadata:e.metadata,iterable:f,metadataKey:"platform"},null,8,["metadata","iterable"])]),_:2},1024)]),_:2},1032,["value"])),[[z,e.tabPlatform===v]])),128))]}),_:1},8,["modelValue"]),pe,l(p,{metadata:e.metadata,iterable:(t=e.config_data)==null?void 0:t.platform_settings,metadataKey:"platform_settings"},null,8,["metadata","iterable"]),l(p,{metadata:(r=(s=e.metadata)==null?void 0:s.platform_settings)==null?void 0:r.items,iterable:(n=(g=e.config_data)==null?void 0:g.platform_settings)==null?void 0:n.rate_limit,metadataKey:"rate_limit"},null,8,["metadata","iterable"]),l(p,{metadata:(U=(C=e.metadata)==null?void 0:C.content_safety)==null?void 0:U.items,iterable:(K=(w=e.config_data)==null?void 0:w.content_safety)==null?void 0:K.baidu_aip,metadataKey:"baidu_aip"},null,8,["metadata","iterable"]),l(p,{metadata:(L=(u=e.metadata)==null?void 0:u.content_safety)==null?void 0:L.items,iterable:(M=(P=e.config_data)==null?void 0:P.content_safety)==null?void 0:M.internal_keywords,metadataKey:"internal_keywords"},null,8,["metadata","iterable"])]}),_:1})]),_:1})):S("",!0),e.tab===1?(d(),i(h,{key:1},{default:o(()=>[l(B,{fluid:""},{default:o(()=>{var t;return[Ve,l(G,{modelValue:e.tabLLM,"onUpdate:modelValue":a[3]||(a[3]=s=>e.tabLLM=s),"align-tabs":"left",color:"deep-purple-accent-4"},{default:o(()=>{var s;return[(d(!0),c(y,null,j((s=e.config_data)==null?void 0:s.llm,(r,g)=>(d(),i(I,{key:g,value:g},{default:o(()=>[k(b(r.name),1)]),_:2},1032,["value"]))),128))]}),_:1},8,["modelValue"]),l(T,{modelValue:e.tabLLM,"onUpdate:modelValue":a[4]||(a[4]=s=>e.tabLLM=s)},{default:o(()=>{var s;return[(d(!0),c(y,null,j((s=e.config_data)==null?void 0:s.llm,(r,g)=>O((d(),i(h,{key:g,value:g},{default:o(()=>[l(B,null,{default:o(()=>[l(p,{metadata:e.metadata,iterable:r,metadataKey:"llm"},null,8,["metadata","iterable"]),l(p,{metadata:e.metadata.llm.items,iterable:r.model_config,metadataKey:"model_config"},null,8,["metadata","iterable"]),l(p,{metadata:e.metadata.llm.items,iterable:r.image_generation_model_config,metadataKey:"image_generation_model_config"},null,8,["metadata","iterable"])]),_:2},1024)]),_:2},1032,["value"])),[[z,e.tabLLM===g]])),128))]}),_:1},8,["modelValue"]),ve,l(p,{metadata:e.metadata,iterable:(t=e.config_data)==null?void 0:t.llm_settings,metadataKey:"llm_settings"},null,8,["metadata","iterable"])]}),_:1})]),_:1})):S("",!0),e.tab===2?(d(),i(h,{key:2},{default:o(()=>[l(B,{fluid:""},{default:o(()=>[l(N,{style:{"margin-top":"16px"}},{default:o(()=>[(d(!0),c(y,null,j(e.common_configs_key,t=>{var s,r,g,n,C,U,w,K;return d(),c("div",{key:t},[((s=e.metadata[t])==null?void 0:s.type)==="string"&&t!=="name"?(d(),i(D,{key:0,modelValue:e.config_data[t],"onUpdate:modelValue":u=>e.config_data[t]=u,label:((r=e.metadata[t])==null?void 0:r.description)+"("+t+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):S("",!0),((g=e.metadata[t])==null?void 0:g.type)==="int"&&t!=="name"?(d(),i(D,{key:1,modelValue:e.config_data[t],"onUpdate:modelValue":u=>e.config_data[t]=u,label:((n=e.metadata[t])==null?void 0:n.description)+"("+t+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):((C=e.metadata[t])==null?void 0:C.type)==="bool"?(d(),i(H,{key:2,modelValue:e.config_data[t],"onUpdate:modelValue":u=>e.config_data[t]=u,label:((U=e.metadata[t])==null?void 0:U.description)+"("+t+")",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label"])):((w=e.metadata[t])==null?void 0:w.type)==="list"?(d(),i(J,{key:3,variant:"outlined",modelValue:e.config_data[t],"onUpdate:modelValue":u=>e.config_data[t]=u,chips:"",clearable:"",label:((K=e.metadata[t])==null?void 0:K.description)+"("+t+")",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:o(({attrs:u,item:L,select:P,selected:M})=>[l(Q,W(u,{"model-value":M,closable:"",onClick:P,"onClick:close":_=>e.remove(L)}),{default:o(()=>[V("strong",null,b(L),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):S("",!0)])}),128))]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1},8,["modelValue"])]),_:1}),l(q,{icon:"mdi-content-save",size:"x-large",style:{position:"fixed",right:"52px",bottom:"52px"},color:"darkprimary",onClick:e.updateConfig},null,8,["onClick"]),l(le,{timeout:2e3,elevation:"24",color:e.save_message_success,modelValue:e.save_message_snack,"onUpdate:modelValue":a[6]||(a[6]=t=>e.save_message_snack=t)},{default:o(()=>[k(b(e.save_message),1)]),_:1},8,["color","modelValue"])],64)}}});export{Ke as default};
